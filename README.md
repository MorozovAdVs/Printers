# Printers
Необходимые скрипты для работы Windows-принтсервера.

С 2021 года групповая политика по установке принтеров была отключена из за уязвимости. Без внесения правок в реестре политику включить невозможно. Включение политики открывает уязвимость.
Чтобы это обойти мною была придумана следующая схема:
1) При загрузке компьютера пользователя, выполняется .cmd скрипт, который ставит все драйвера, которые установлены на принтсервере (дравйеров должно быть как можно меньше).
.cmd нужно отредактировать под нужды компании. Вместо set driverdirectory=\\corp.corp\NETLOGON\drv нужно указать рабочую директорию с драйверами принтеров. Такая есть на самом принтсервере, дополнительно её создавать не обязательно.
rundll32.exe printui.dll,PrintUIEntry /ia /u /m "HP Universal Printing PCL 6 (v7.2.0)" - здесь нужно заменить имя драйвера. Имя драйвера можно посмотреть в параметрах сервера печати.

При входе пользователя на его рабочий стол публикуется ярлык на скрипт .vbs. Скрипт ищет среди групп пользователя группы, полностью идентичные названию принтеров, добавляет имя принтсервера к группе и подклюает сетевой принтер по его полному имени (сетевому пути).
Скрипт написан под 2 принтсервера. Для работы обоих нужно, чтобы названия групп на 1 принтсервере и на 2 имели свои отличительные особенности. В этом скрипте это: If InStr(PrinterName, "str") > 0 Then ServerLink = "\\str-prn\" Т.е. если имя группы содержит str, то обращение будет по сетевому пути к серверу str-prn.

CreateObject("WScript.Shell").Run "control /name {A8A91A66-3A7D-4424-8D24-04E180695C7A}" открывает control printers. В Windows 11 при выполнении control printers появляется не такая понятная для пользователей новая страница настроек, при вызове по GUID - открывается старая.
